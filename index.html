<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Theo dõi đơn hàng</title>
    <link rel="stylesheet" href="index.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap"
    />
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
  <script type="importmap">
{
  "imports": {
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.23.0",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "serve": "https://aistudiocdn.com/serve@^14.2.5",
    "web-push": "https://aistudiocdn.com/web-push@^3.6.7",
    "deno.ns": "https://aistudiocdn.com/deno.ns@^0.8.0"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
  <body>
    <div id="app">
      <header>
        <div class="header-left">
          <div class="nav-container">
            <button class="nav-menu-btn" aria-label="Điều hướng nhanh">
              <span></span>
              <span></span>
              <span></span>
            </button>
            <nav class="nav-menu">
              <ul>
                <li><a href="#in-production-column">ĐANG SẢN XUẤT</a></li>
                <li><a href="#waiting-column">ĐƠN HÀNG CHỜ</a></li>
                <li><a href="#completed-column">SẢN XUẤT XONG</a></li>
              </ul>
            </nav>
          </div>
          <h1>Bảng theo dõi đơn hàng</h1>
          <div id="connection-status" class="connection-status-indicator">
            <span class="status-dot"></span>
            <span class="status-text"></span>
          </div>
        </div>
        <div class="header-actions">
          <div class="search-bar-container">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="search-icon">
              <path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 10-1.06-1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd" />
            </svg>
            <input type="search" id="search-input" name="search-input" placeholder="Tìm theo tên, nhà máy...">
          </div>
          <button id="enable-notifications-btn" class="header-action-btn" aria-label="Bật thông báo" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
              <path d="M10 2a6 6 0 00-6 6v3.586l-1.707 1.707A1 1 0 003 15h14a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z" />
            </svg>
          </button>
          <button id="add-order-btn" class="header-add-btn" aria-label="Thêm đơn hàng mới">
            + Thêm đơn hàng
          </button>
          <div id="user-display" class="user-display" hidden>
            <span id="user-email"></span>
          </div>
          <button id="login-btn" class="auth-btn" aria-label="Đăng nhập">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"></path>
            </svg>
          </button>
          <button id="logout-btn" class="auth-btn" aria-label="Đăng xuất" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
              <path d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5-5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"></path>
            </svg>
          </button>
        </div>
      </header>
      <div id="notification-container"></div>
      <main class="kanban-board">
        <div id="global-error" class="global-error" hidden></div>
        <div class="kanban-column" id="in-production-column" data-status="inProduction">
          <div class="kanban-column-header">
            <h2>ĐANG SẢN XUẤT</h2>
            <div class="sort-container">
              <div class="sort-options">
                <button data-sort="priority">Độ ưu tiên</button>
                <button data-sort="factory">Nhà máy</button>
                <button data-sort="quantity">Số lượng</button>
                <button data-sort="deliveryDate">Ngày giao hàng</button>
              </div>
              <button class="sort-btn">&lt; SẮP XẾP</button>
            </div>
          </div>
          <div class="order-list" id="in-production-orders"></div>
        </div>
        <div class="kanban-column" id="waiting-column" data-status="waiting">
          <div class="kanban-column-header">
            <h2>ĐƠN HÀNG CHỜ</h2>
             <div class="sort-container">
               <div class="sort-options">
                <button data-sort="createdAt">Thời gian tải</button>
                <button data-sort="factory">Nhà máy</button>
                <button data-sort="quantity">Số lượng</button>
                <button data-sort="deliveryDate">Ngày giao hàng</button>
              </div>
              <button class="sort-btn">&lt; SẮP XẾP</button>
            </div>
          </div>
          <div class="order-list" id="waiting-orders"></div>
        </div>
        <div class="kanban-column" id="completed-column" data-status="completed">
          <div class="kanban-column-header">
            <h2>SẢN XUẤT XONG</h2>
             <div class="sort-container">
              <div class="sort-options">
                <button data-sort="factory">Nhà máy</button>
                <button data-sort="quantity">Số lượng</button>
                <button data-sort="completedAt">Ngày hoàn thành</button>
              </div>
              <button class="sort-btn">&lt; SẮP XẾP</button>
            </div>
          </div>
          <div class="order-list" id="completed-orders"></div>
        </div>
      </main>

      <div id="order-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-title">
        <div class="modal-content">
          <button id="close-modal-btn" class="close-btn" aria-label="Đóng">&times;</button>
          <h2 id="modal-title">Thêm đơn hàng mới</h2>
          <form id="order-form">
            <div class="modal-body">
              <div class="form-details">
                <div class="form-group">
                  <input type="text" id="order-name" name="order-name" placeholder="TÊN ĐƠN HÀNG" required />
                </div>
                <div class="form-group">
                  <select id="order-factory" name="order-factory" required>
                    <option value="" disabled selected hidden>NHÀ MÁY</option>
                    <option value="MAFA">MAFA</option>
                    <option value="ACLA">ACLA</option>
                  </select>
                </div>
                <div class="form-group quantity-group">
                  <input type="number" id="order-quantity" name="order-quantity" placeholder="SỐ LƯỢNG" required />
                  <span>Tờ</span>
                </div>
                <div class="form-group unit-group">
                  <input type="number" id="order-unit" name="order-unit" placeholder="SỐ BỘ" required />
                  <span>Bộ</span>
                </div>
                <div class="form-group">
                  <label for="order-delivery-date" class="date-label">NGÀY GIAO HÀNG</label>
                  <input type="date" id="order-delivery-date" name="order-delivery-date" />
                </div>
              </div>
              <div class="image-upload-area">
                <label for="order-image" class="upload-label">
                  <img id="image-preview" src="#" alt="Xem trước hình ảnh" hidden/>
                  <div id="upload-placeholder" class="upload-placeholder">
                    <span>+ Tải ảnh lên</span>
                  </div>
                </label>
                <input type="file" id="order-image" name="order-image" accept="image/*" />
              </div>
            </div>
            <div class="modal-footer">
                <button type="submit" id="submit-order-btn" class="btn-submit">Thêm đơn hàng</button>
            </div>
          </form>
        </div>
      </div>
      
      <!-- Login Modal -->
      <div id="login-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="login-modal-title">
        <div class="modal-content login-content">
           <button id="close-login-modal-btn" class="close-btn" aria-label="Đóng">&times;</button>
          <h2 id="login-modal-title">Đăng nhập</h2>
          <form id="login-form">
              <div class="form-group">
                <input type="email" id="email-input" name="email-input" placeholder="Email" required>
              </div>
              <div class="form-group">
                <input type="password" id="password-input" name="password-input" placeholder="Mật khẩu" required>
              </div>
              <p id="login-error" class="login-error" hidden></p>
              <button type="submit" class="btn-submit">Đăng nhập</button>
          </form>
        </div>
      </div>
      
      <!-- Review Modal -->
      <div id="review-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="review-modal-title">
        <div class="modal-content review-modal-content">
          <button id="close-review-modal-btn" class="close-btn" aria-label="Đóng">&times;</button>
          <h2 id="review-modal-title">Review cho đơn hàng</h2>
          <div id="review-list" class="review-list">
            <!-- Reviews will be loaded here -->
          </div>
          <form id="review-form">
            <div class="form-group">
              <textarea id="review-content" name="review-content" placeholder="Thêm review..." required></textarea>
            </div>
            <button type="submit" class="btn-submit">Gửi Review</button>
          </form>
        </div>
      </div>
      
      <!-- Confirm Modal -->
      <div id="confirm-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="confirm-modal-title">
        <div class="modal-content confirm-modal-content">
          <h2 id="confirm-modal-title">Xác nhận hành động</h2>
          <p id="confirm-modal-message">Bạn có chắc chắn muốn thực hiện hành động này?</p>
          <div class="modal-footer confirm-modal-footer">
            <button id="confirm-modal-cancel-btn" class="btn-cancel">Hủy</button>
            <button id="confirm-modal-confirm-btn" class="btn-confirm-delete">Xác nhận xóa</button>
          </div>
        </div>
      </div>

    </div>
    <script type="module" src="index.tsx"></script>
  <script type="module" src="/index.tsx"></script>
</body>
</html>